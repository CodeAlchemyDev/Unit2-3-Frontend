{"ast":null,"code":"import _defineProperty from\"/Users/amber/Lambda/03_Web Applications II/04_unit-3-build/Unit2-3-Frontend/schoolinthecloud/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/amber/Lambda/03_Web Applications II/04_unit-3-build/Unit2-3-Frontend/schoolinthecloud/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/amber/Lambda/03_Web Applications II/04_unit-3-build/Unit2-3-Frontend/schoolinthecloud/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import*as yup from\"yup\";import{apiAuth}from\"../../utils/apiAuth\";// import changeHandler from \"../../helpers/changeHandler\";\n// import Button from \"../buttons/Buttons\";\nexport default function SignInForm(props){// Set up yup validation schema\nvar formSchema=yup.object().shape({userName:yup.string().required(\"Please enter your username\").min(4,\"Username should be longer than 4 characters\"),password:yup.string().required(\"Please enter your password\").min(3,\"Password should be longer than 3 characters\")});// Form state and error state respectively\nvar _useState=useState({userName:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),formState=_useState2[0],setFormState=_useState2[1];var _useState3=useState({userName:\"\",password:\"\"}),_useState4=_slicedToArray(_useState3,2),errorState=_useState4[0],setErrorState=_useState4[1];// validation on input change\nvar validate=function validate(e){yup.reach(formSchema,e.target.name).validate(e.target.value).then(function(valid){setErrorState(_objectSpread(_objectSpread({},errorState),{},_defineProperty({},e.target.name,\"\")));}).catch(function(err){setErrorState(_objectSpread(_objectSpread({},errorState),{},_defineProperty({},e.target.name,err.errors[0])));});};var inputChange=function inputChange(e){e.persist();console.log(e.target.value);validate(e);setFormState(_objectSpread(_objectSpread({},formState),{},_defineProperty({},e.target.name,e.target.value)));};var formSubmit=function formSubmit(e){// console.log(\"submit\");\n// console.log(formState);\ne.preventDefault();apiAuth().post(\"/login\",{formState:formState}).then(function(response){console.log(response);localStorage.setItem(\"token\",response.data.token);// props.history.push(\"/\");\n}).catch(function(err){console.log(err);});};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:formSubmit,className:\"signInForm\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"signInTitle\"},\"Sign In\"),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"userName\"},\"Username:\",/*#__PURE__*/React.createElement(\"input\",{className:\"signInInput\",type:\"text\",name:\"userName\",id:\"userName\",value:formState.userName,onChange:inputChange})),errorState.userName.length>0?/*#__PURE__*/React.createElement(\"p\",{className:\"error\"},errorState.userName):null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"password\"},\"Password:\",/*#__PURE__*/React.createElement(\"input\",{className:\"signInInput\",type:\"password\",name:\"password\",id:\"password\",value:formState.password,onChange:inputChange})),errorState.password.length>0?/*#__PURE__*/React.createElement(\"p\",{className:\"error\"},errorState.password):null,/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"Login\")));}","map":{"version":3,"sources":["/Users/amber/Lambda/03_Web Applications II/04_unit-3-build/Unit2-3-Frontend/schoolinthecloud/src/components/forms/SignInForm.js"],"names":["React","useState","useEffect","yup","apiAuth","SignInForm","props","formSchema","object","shape","userName","string","required","min","password","formState","setFormState","errorState","setErrorState","validate","e","reach","target","name","value","then","valid","catch","err","errors","inputChange","persist","console","log","formSubmit","preventDefault","post","response","localStorage","setItem","data","token","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport * as yup from \"yup\";\nimport { apiAuth } from \"../../utils/apiAuth\";\n// import changeHandler from \"../../helpers/changeHandler\";\n// import Button from \"../buttons/Buttons\";\n\nexport default function SignInForm(props) {\n  // Set up yup validation schema\n  const formSchema = yup.object().shape({\n    userName: yup\n      .string()\n      .required(\"Please enter your username\")\n      .min(4, \"Username should be longer than 4 characters\"),\n    password: yup\n      .string()\n      .required(\"Please enter your password\")\n      .min(3, \"Password should be longer than 3 characters\"),\n  });\n\n  // Form state and error state respectively\n  const [formState, setFormState] = useState({\n    userName: \"\",\n    password: \"\",\n  });\n\n  const [errorState, setErrorState] = useState({\n    userName: \"\",\n    password: \"\",\n  });\n\n  // validation on input change\n  const validate = (e) => {\n    yup\n      .reach(formSchema, e.target.name)\n      .validate(e.target.value)\n      .then((valid) => {\n        setErrorState({\n          ...errorState,\n          [e.target.name]: \"\",\n        });\n      })\n      .catch((err) => {\n        setErrorState({\n          ...errorState,\n          [e.target.name]: err.errors[0],\n        });\n      });\n  };\n  const inputChange = (e) => {\n    e.persist();\n    console.log(e.target.value);\n    validate(e);\n    setFormState({ ...formState, [e.target.name]: e.target.value });\n  };\n\n  const formSubmit = (e) => {\n    // console.log(\"submit\");\n    // console.log(formState);\n    e.preventDefault();\n    apiAuth()\n      .post(\"/login\", { formState })\n      .then((response) => {\n        console.log(response);\n        localStorage.setItem(\"token\", response.data.token);\n        // props.history.push(\"/\");\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  return (\n    <>\n      <form onSubmit={formSubmit} className=\"signInForm\">\n        <h2 className=\"signInTitle\">Sign In</h2>\n\n        <label htmlFor=\"userName\">\n          Username:\n          <input\n            className=\"signInInput\"\n            type=\"text\"\n            name=\"userName\"\n            id=\"userName\"\n            value={formState.userName}\n            onChange={inputChange}\n          />\n        </label>\n\n        {errorState.userName.length > 0 ? (\n          <p className=\"error\">{errorState.userName}</p>\n        ) : null}\n\n        <label htmlFor=\"password\">\n          Password:\n          <input\n            className=\"signInInput\"\n            type=\"password\"\n            name=\"password\"\n            id=\"password\"\n            value={formState.password}\n            onChange={inputChange}\n          />\n        </label>\n\n        {errorState.password.length > 0 ? (\n          <p className=\"error\">{errorState.password}</p>\n        ) : null}\n\n        <button type=\"submit\">Login</button>\n      </form>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}